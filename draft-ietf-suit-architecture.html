<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>A Firmware Update Architecture for Internet of Things</title>
<meta content="Brendan Moran" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="David Brown" name="author">
<meta content="Milosch Meriac" name="author">
<meta content="
       Vulnerabilities with Internet of Things (IoT) devices have raised
the need for a solid and secure firmware update mechanism that is
also suitable for constrained devices. Incorporating such update
mechanism to fix vulnerabilities, to update configuration settings
as well as adding new functionality is recommended by security
experts. 
       This document lists requirements and describes an architecture for
a firmware update mechanism suitable for IoT devices. The
architecture is agnostic to the transport of the firmware images
and associated meta-data. 
    " name="description">
<meta content="xml2rfc 3.0.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-suit-architecture-12" name="ietf.draft">
<link href="./draft-ietf-suit-architecture.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">A Firmware Update Architecture for IoT</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Moran, et al.</td>
<td class="center">Expires March 15, 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SUIT</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-suit-architecture-12</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-11" class="published">September 11, 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-03-15">March 15, 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Moran</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">D. Brown</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">M. Meriac</div>
<div class="org">Consultant</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">A Firmware Update Architecture for Internet of Things</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Vulnerabilities with Internet of Things (IoT) devices have raised
the need for a solid and secure firmware update mechanism that is
also suitable for constrained devices. Incorporating such update
mechanism to fix vulnerabilities, to update configuration settings
as well as adding new functionality is recommended by security
experts.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document lists requirements and describes an architecture for
a firmware update mechanism suitable for IoT devices. The
architecture is agnostic to the transport of the firmware images
and associated meta-data.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on March 15, 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-terminology-2" class="xref">Conventions and Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-requirements-2" class="xref">Requirements</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-agnostic-to-how-firmware-ima" class="xref">Agnostic to how firmware images are distributed</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-friendly-to-broadcast-delive" class="xref">Friendly to broadcast delivery</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-use-state-of-the-art-securit" class="xref">Use state-of-the-art security mechanisms</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-rollback-attacks-must-be-pre" class="xref">Rollback attacks must be prevented</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-high-reliability-2" class="xref">High reliability</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-operate-with-a-small-bootloa" class="xref">Operate with a small bootloader</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-small-parsers-2" class="xref">Small Parsers</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-minimal-impact-on-existing-f" class="xref">Minimal impact on existing firmware formats</a><a href="#section-toc.1-1.3.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-robust-permissions-2" class="xref">Robust permissions</a><a href="#section-toc.1-1.3.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-operating-modes-2" class="xref">Operating modes</a><a href="#section-toc.1-1.3.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.11">
                <p id="section-toc.1-1.3.2.11.1"><a href="#section-3.11" class="xref">3.11</a>. <a href="#name-suitability-to-software-and-" class="xref">Suitability to software and personalization data</a><a href="#section-toc.1-1.3.2.11.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-claims-2" class="xref">Claims</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-communication-architecture-2" class="xref">Communication Architecture</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-manifest-2" class="xref">Manifest</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-device-firmware-update-examp" class="xref">Device Firmware Update Examples</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-single-cpu-soc-2" class="xref">Single CPU SoC</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-single-cpu-with-secure-norma" class="xref">Single CPU with Secure - Normal Mode Partitioning</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-symmetric-multiple-cpus-2" class="xref">Symmetric Multiple CPUs</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-dual-cpu-shared-memory-2" class="xref">Dual CPU, shared memory</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-dual-cpu-other-bus-2" class="xref">Dual CPU, other bus</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-bootloader-2" class="xref">Bootloader</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-example-2" class="xref">Example</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations-2" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations-2" class="xref">Security Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-acknowledgements-2" class="xref">Acknowledgements</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-informative-references-2" class="xref">Informative References</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When developing Internet of Things (IoT) devices, one of the most difficult problems
to solve is how to update firmware on the device. Once the
device is deployed, firmware updates play a critical part in its
lifetime, particularly when devices have a long lifetime, are
deployed in remote or inaccessible areas where manual
intervention is cost prohibitive or otherwise difficult. Updates
to the firmware of an IoT device are done to fix bugs in software,
to add new functionality, and to re-configure the device to work
in new environments or to behave differently in an already
deployed context.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The firmware update process, among other goals, has to ensure that<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">The firmware image is authenticated and integrity protected.
Attempts to flash a modified firmware image or an image from
an unknown source are prevented.<a href="#section-1-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-3.2">The firmware image can be confidentiality protected so that
attempts by an adversary to recover the plaintext binary can
be prevented. Obtaining the firmware is often one of
the first steps to mount an attack since it gives the adversary
valuable insights into used software libraries, configuration
settings and generic functionality (even though reverse
engineering the binary can be a tedious process).<a href="#section-1-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-4">This version of the document assumes asymmetric cryptography and
a public key infrastructure. Future versions may also describe
a symmetric key approach for very constrained devices.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">While the standardization work has been informed by and optimised for firmware
update use cases of Class 1 devices (according to the device class
definitions in RFC 7228 <span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span>) devices, there is nothing in
the architecture that restricts its use to only these constrained IoT devices.
Moreover, this architecture is not limited to managing software updates,
but can also be applied to managing the delivery of arbitrary data, such
as configuration information and keys.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">More details about the security goals are discussed in
<a href="#architecture" class="xref">Section 5</a> and requirements are described in <a href="#requirements" class="xref">Section 3</a>.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology-2" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">This document uses the following terms:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Manifest: The manifest contains meta-data about the firmware
image. The manifest is protected against modification and
provides information about the author.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">Firmware Image: The firmware image, or image, is a binary
that may contain the complete software of a device or a subset of
it. The firmware image may consist of multiple images, if
the device contains more than one microcontroller. Often
it is also a compressed archive that contains code,
configuration data, and even the entire file system. The
image may consist of a differential update for performance
reasons. Firmware is the more universal term. The terms,
firmware image, firmware, and image, are used in this
document and are interchangeable.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Software: The terms "software" and "firmware" are used
interchangeably.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Bootloader: A bootloader is a piece of software that is
executed once a microcontroller has been reset. It is
responsible for deciding whether to boot a firmware image
that is present or whether to obtain and verify a new
firmware image. Since the bootloader is a security critical
component its functionality may be split into separate stages.
Such a multi-stage bootloader may offer very basic functionality
in the first stage and resides in ROM whereas the second stage
may implement more complex functionality and resides in flash
memory so that it can be updated in the future (in case bugs
have been found). The exact split of components into the
different stages, the number of firmware images stored by an
IoT device, and the detailed functionality varies throughout
different implementations. A more detailed discussion is
provided in <a href="#bootloader" class="xref">Section 8</a>.<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.5">Microcontroller (MCU for microcontroller unit): An MCU is a
compact integrated circuit designed for use in embedded systems.
A typical microcontroller includes a processor, memory (RAM and
flash), input/output (I/O) ports and other features connected via
some bus on a single chip. The term 'system on chip (SoC)' is
often used for these types of devices.<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.6">System on Chip (SoC): An SoC is an integrated circuit that
integrates all components of a computer, such as CPU, memory,
input/output ports, secondary storage, etc.<a href="#section-2-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.7">Homogeneous Storage Architecture (HoSA): A device that stores
all firmware components in the same way, for example in a file
system or in flash memory.<a href="#section-2-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.8">Heterogeneous Storage Architecture (HeSA): A device that
stores at least one firmware component differently from the rest,
for example a device with an external, updatable radio, or a
device with internal and external flash memory.<a href="#section-2-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.9">Trusted Execution Environments (TEEs): An execution environment
that runs alongside of, but is isolated from, an REE.<a href="#section-2-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.10">Rich Execution Environment (REE): An environment that is provided
and governed by a typical OS (e.g., Linux, Windows, Android, iOS),
potentially in conjunction with other supporting operating systems
and hypervisors; it is outside of the TEE.  This environment and
applications running on it are considered un-trusted.<a href="#section-2-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.11">Trusted applications (TAs): An application component that runs in
a TEE.<a href="#section-2-2.11" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">For more information about TEEs see <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>. TEEP
requires the use of SUIT for delivering TAs.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The following entities are used:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">Author: The author is the entity that creates the firmware image.
There may be multiple authors in a system either when a device
consists of multiple micro-controllers or when the the final
firmware image consists of software components from multiple
companies.<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.2">Firmware Consumer: The firmware consumer is the recipient of the
firmware image and the manifest. It is responsible for parsing
and verifying the received manifest and for storing the obtained
firmware image. The firmware consumer plays the role of the
update component on the IoT device typically running in the
application firmware. It interacts with the firmware server and
with the status tracker, if present.<a href="#section-2-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.3">(IoT) Device: A device refers to the entire IoT product, which
consists of one or many MCUs, sensors and/or actuators. Many IoT
devices sold today contain multiple MCUs and therefore a single
device may need to obtain more than one firmware image and
manifest to succesfully perform an update. The terms device and
firmware consumer are used interchangably since the firmware
consumer is one software component running on an MCU on the device.<a href="#section-2-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.4">Status Tracker: The status tracker offers device management
functionality to retrieve information about the installed firmware
on a device and other device characteristics (including free memory
and hardware components), to obtain the state of the firmware update
cycle the device is currently in, and to trigger the update process.
The deployment of status trackers is flexible and they may be used
as cloud-based servers, on-premise servers, embedded in edge computing device
(such as Internet access gateways or protocol translation gateways),
or even in smart phones and tablets. IoT devices that self-initiate
updates may run a status tracker. Similarly, IoT devices that act as a
proxy for other IoT devices in a protocol translation or edge
computing device node may also run a status tracker.
However, if the device contains multiple MCUs, the main MCU may act
as a limited status tracker towards the other MCUs if updates are to be
synchronized across MCUs.
How much functionality a status tracker includes depends on the selected
configuration of the device management functionality and the communication
environment it is used in. In a generic networking environment the protocol
used between the client and the server-side of the status tracker need to
deal with Internet communication challenges involving firewall and NAT traversal.
In other cases, the communication interaction may be rather simple. This
architecture document does not impose requirements on the status tracker.<a href="#section-2-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.5">
          <p id="section-2-5.5.1">Firmware Server: The firmware server stores firmware images and manifests and
distributes them to IoT devices.
Some deployments may require a store-and-forward concept, which requires
storing the firmware images/manifests on more than one entity before<a href="#section-2-5.5.1" class="pilcrow">¶</a></p>
<p id="section-2-5.5.2">
they reach the device. There is typically some interaction between the
firmware server and the status tracker but those entities are often
physically separated on different devices for scalability reasons.<a href="#section-2-5.5.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-5.6">Device Operator: The actor responsible for the day-to-day operation
of a fleet of IoT devices.<a href="#section-2-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.7">Network Operator: The actor responsible for the operation of a
network to which IoT devices connect.<a href="#section-2-5.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.8">Claim: A piece of information asserted about a recipient or payload.<a href="#section-2-5.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-6">In addition to the entities in the list above there is an orthogonal
infrastructure with a Trust Provisioning Authority (TPA) distributing
trust anchors and authorization permissions to various entities in
the system. The TPA may also delegate rights to install, update,
enhance, or delete trust anchors and authorization permissions to
other parties in the system. This infrastructure overlaps the
communication architecture and different deployments may empower
certain entities while other deployments may not. For example,
in some cases, the Original Design Manufacturer (ODM), which is a
company that designs and manufactures a product, may act as a
TPA and may decide to remain in full control over the firmware
update process of their products.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">The terms 'trust anchor' and 'trust anchor store' are defined in
<span>[<a href="#RFC6024" class="xref">RFC6024</a>]</span>:<a href="#section-2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.1">"A trust anchor represents an authoritative entity via a public
key and associated data.  The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative."<a href="#section-2-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-8.2">"A trust anchor store is a set of one or more trust anchors stored
in a device.  A device may have more than one trust anchor store,
each of which may be used by one or more applications."
A trust anchor store must resist modification against unauthorized
insertion, deletion, and modification.<a href="#section-2-8.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="requirements">
<section id="section-3">
      <h2 id="name-requirements-2">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-requirements-2" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-3-1">The firmware update mechanism described in this specification
was designed with the following requirements in mind:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Agnostic to how firmware images are distributed<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Friendly to broadcast delivery<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">Use state-of-the-art security mechanisms<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.4">Rollback attacks must be prevented<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.5">High reliability<a href="#section-3-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.6">Operate with a small bootloader<a href="#section-3-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.7">Small Parsers<a href="#section-3-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.8">Minimal impact on existing firmware formats<a href="#section-3-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.9">Robust permissions<a href="#section-3-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.10">Diverse modes of operation<a href="#section-3-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.11">Suitability to software and personalization data<a href="#section-3-2.11" class="pilcrow">¶</a>
</li>
      </ul>
<div id="agnostic-to-how-firmware-images-are-distributed">
<section id="section-3.1">
        <h3 id="name-agnostic-to-how-firmware-ima">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-agnostic-to-how-firmware-ima" class="section-name selfRef">Agnostic to how firmware images are distributed</a>
        </h3>
<p id="section-3.1-1">Firmware images can be conveyed to devices in a variety of ways,
including USB, UART, WiFi, BLE, low-power WAN technologies, etc.
and use different protocols (e.g., CoAP, HTTP). The specified
mechanism needs to be agnostic to the distribution of the
firmware images and manifests.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="friendly-to-broadcast-delivery">
<section id="section-3.2">
        <h3 id="name-friendly-to-broadcast-delive">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-friendly-to-broadcast-delive" class="section-name selfRef">Friendly to broadcast delivery</a>
        </h3>
<p id="section-3.2-1">This architecture does not specify any specific broadcast protocol.
However, given that broadcast may be desirable for some networks,
updates must cause the least disruption possible both in metadata
and firmware transmission.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For an update to be broadcast friendly, it cannot rely on link
layer, network layer, or transport layer security. A solution has
to rely on security protection applied to the manifest and firmware image
instead. In addition,
the same manifest must be deliverable to many devices, both those
to which it applies and those to which it does not, without a
chance that the wrong device will accept the update. Considerations
that apply to network broadcasts apply equally to the use of
third-party content distribution networks for payload distribution.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-state-of-the-art-security-mechanisms">
<section id="section-3.3">
        <h3 id="name-use-state-of-the-art-securit">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-use-state-of-the-art-securit" class="section-name selfRef">Use state-of-the-art security mechanisms</a>
        </h3>
<p id="section-3.3-1">End-to-end security between the author and the device is shown in
<a href="#architecture" class="xref">Section 5</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Authentication ensures that the device can cryptographically identify
the author(s) creating firmware images and manifests. Authenticated
identities may be used as input to the authorization process.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Integrity protection ensures that no third party can modify the manifest
or the firmware image.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For confidentiality protection of the firmware image, it must be done in such a
way that every intended recipient can decrypt it. The information
that is encrypted individually for each device must maintain
friendliness to Content Distribution Networks, bulk storage, and
broadcast protocols.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">A manifest specification must support different cryptographic algorithms
and algorithm extensibility. Due of the nature of
unchangeable code in ROM for use with bootloaders the use of
post-quantum secure signature mechanisms, such as hash-based
signatures <span>[<a href="#RFC8778" class="xref">RFC8778</a>]</span>, are attractive. These
algorithms maintain security in presence of quantum computers.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">A mandatory-to-implement set of algorithms will be specified in the
manifest specification <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>}.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rollback-attacks-must-be-prevented">
<section id="section-3.4">
        <h3 id="name-rollback-attacks-must-be-pre">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-rollback-attacks-must-be-pre" class="section-name selfRef">Rollback attacks must be prevented</a>
        </h3>
<p id="section-3.4-1">A device presented with an old, but valid manifest and firmware
must not be tricked into installing such firmware since a
vulnerability in the old firmware image may allow an attacker to
gain control of the device.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reliability">
<section id="section-3.5">
        <h3 id="name-high-reliability-2">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-high-reliability-2" class="section-name selfRef">High reliability</a>
        </h3>
<p id="section-3.5-1">A power failure at any time must not cause a failure of the device.
Equally, adverse network conditions during an update must not cause the
failure of the device.
A failure to validate any part of an update must not cause a
failure of the device. One way to achieve this functionality is
to provide a minimum of two storage locations for firmware and one
bootable location for firmware. An alternative approach is to use a
2nd stage bootloader with build-in full featured firmware update
functionality such that it is possible to return to the update
process after power down.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Note: This is an implementation requirement rather than a requirement
on the manifest format.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operate-with-a-small-bootloader">
<section id="section-3.6">
        <h3 id="name-operate-with-a-small-bootloa">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-operate-with-a-small-bootloa" class="section-name selfRef">Operate with a small bootloader</a>
        </h3>
<p id="section-3.6-1">Throughout this document we assume that the bootloader itself is
distinct from the role of the firmware consumer and therefore does not
manage the firmware update process. This may give the impression
that the bootloader itself is a completely separate component,
which is mainly responsible for selecting a firmware image to boot.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">The overlap between the firmware update process and the bootloader
functionality comes in two forms, namely<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-3.1">First, a bootloader must verify the firmware image it boots as
part of the secure boot process. Doing so requires meta-data to be
stored alongside the firmware image so that the bootloader can
cryptographically verify the firmware image before booting it to
ensure it has not been tampered with or replaced. This meta-data
used by the bootloader may well be the same manifest obtained with the
firmware image during the update process (with the severable
fields stripped off).<a href="#section-3.6-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-3.2">Second, an IoT device needs a recovery strategy in case the firmware
update / boot process fails. The recovery strategy may include
storing two or more firmware images on the device or offering the
ability to have a second stage bootloader perform the firmware update
process again using firmware updates over serial, USB or even
wireless connectivity like a limited version of Bluetooth Smart.
In the latter case the firmware consumer functionality is contained in the
second stage bootloader and requires the necessary functionality for
executing the firmware update process, including manifest parsing.<a href="#section-3.6-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-4">In general, it is assumed that the bootloader itself, or a minimal part of it,
will not be updated since a failed update of the bootloader poses a risk
in reliability.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5">All information necessary for a device to make a decision about the
installation of a firmware update must fit into the available RAM of
a constrained IoT device. This prevents flash write exhaustion.
This is typically not a difficult requirement to accomplish because
there are not other task/processing running while the bootloader is
active (unlike it may be the case when running the application firmware).<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">Note: This is an implementation requirement.<a href="#section-3.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="small-parsers">
<section id="section-3.7">
        <h3 id="name-small-parsers-2">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-small-parsers-2" class="section-name selfRef">Small Parsers</a>
        </h3>
<p id="section-3.7-1">Since parsers are known sources of bugs, any parsers used to process the
manifest must be minimal.
Additionally, it must be easy to parse only those fields that are
required to validate at least one signature or MAC with minimal
exposure.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="minimal-impact-on-existing-firmware-formats">
<section id="section-3.8">
        <h3 id="name-minimal-impact-on-existing-f">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-minimal-impact-on-existing-f" class="section-name selfRef">Minimal impact on existing firmware formats</a>
        </h3>
<p id="section-3.8-1">The design of the firmware update mechanism must not require
changes to existing firmware formats.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="robust-permissions">
<section id="section-3.9">
        <h3 id="name-robust-permissions-2">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-robust-permissions-2" class="section-name selfRef">Robust permissions</a>
        </h3>
<p id="section-3.9-1">When a device obtains a monolithic firmware image from a single author
without any additional approval steps then the authorization flow is
relatively simple. There are, however, other cases where more complex
policy decisions need to be made before updating a device.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">In this architecture the authorization policy is separated from
the underlying communication architecture. This is accomplished
by separating the entities from their permissions. For example,
an author may not have the authority to install a firmware image
on a device in critical infrastructure without the authorization
of a device operator. In this case, the device may be programmed
to reject firmware updates unless they are signed both by the
firmware author and by the device operator.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
<p id="section-3.9-3">Alternatively, a device may trust precisely one entity, which
does all permission management and coordination. This entity
allows the device to offload complex permissions
calculations for the device.<a href="#section-3.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operating-modes">
<section id="section-3.10">
        <h3 id="name-operating-modes-2">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-operating-modes-2" class="section-name selfRef">Operating modes</a>
        </h3>
<p id="section-3.10-1">There are three broad classifications of update operating modes.<a href="#section-3.10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.10-2.1">Client-initiated Update<a href="#section-3.10-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-2.2">Server-initiated Update<a href="#section-3.10-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-2.3">Hybrid Update<a href="#section-3.10-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.10-3">Client-initiated updates take the form of a firmware consumer on
a device proactively checking (polling) for new firmware images.<a href="#section-3.10-3" class="pilcrow">¶</a></p>
<p id="section-3.10-4">Server-initiated updates are important to consider because
timing of updates may need to be tightly controlled in some high-
reliability environments. In this case the status tracker determines
what devices qualify for a firmware update. Once those devices have been
selected the firmware server distributes updates to the firmware consumers.<a href="#section-3.10-4" class="pilcrow">¶</a></p>
<p id="section-3.10-5">Note: This assumes that the status tracker is able to reach the
device, which may require devices to keep reachability information at
the status tracker up-to-date. This may also require keeping state at
NATs and stateful packet filtering firewalls alive.<a href="#section-3.10-5" class="pilcrow">¶</a></p>
<p id="section-3.10-6">Hybrid updates are those that require an interaction between the
firmware consumer and the status tracker. The status tracker
pushes notifications of availability of an update to the firmware consumer,
and it then downloads the image from a firmware server
as soon as possible.<a href="#section-3.10-6" class="pilcrow">¶</a></p>
<p id="section-3.10-7">While these broad classifications encompass the majority of operating
modes, some may not be covered in these classifications. By
reinterpreting these modes as a set of operations performed by the
system as a whole, all operating modes can be represented.<a href="#section-3.10-7" class="pilcrow">¶</a></p>
<p id="section-3.10-8">The steps performed in the course of an update by the system containing an updatable device are:<a href="#section-3.10-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.10-9.1">Notification<a href="#section-3.10-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-9.2">Pre-authorisation<a href="#section-3.10-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-9.3">Dependency resolution<a href="#section-3.10-9.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-9.4">Download<a href="#section-3.10-9.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-9.5">Installation<a href="#section-3.10-9.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.10-10">This is a coarse-grained high level view of steps required to install a
new firmware. By considering where in the system each of these steps is
performed, each operating mode can be represented. Each of these steps
is broken down into smaller constituent parts. <a href="#architecture" class="xref">Section 5</a> defines
the steps taken from the perspective of the communication between
actors in the system. <a href="#bootloader" class="xref">Section 8</a> describes some additional steps
that a bootloader takes in addition to those described here. <a href="#example" class="xref">Section 9</a>
shows an example of the steps undertaken by each party in the course
of an update.<a href="#section-3.10-10" class="pilcrow">¶</a></p>
<p id="section-3.10-11">The notification step consists of the status tracker informing the
firmware consumer that an update is available. This can be accomplished via
polling (client-initiated), push notifications (server-initiated),
or more complex mechanisms.<a href="#section-3.10-11" class="pilcrow">¶</a></p>
<p id="section-3.10-12">The pre-authorisation step involves verifying whether the entity
signing the manifest is indeed authorized to perform an update.
The firmware consumer must also determine whether it should fetch and
process a firmware image, which is referenced in a manifest.<a href="#section-3.10-12" class="pilcrow">¶</a></p>
<p id="section-3.10-13">A dependency resolution phase is needed when more than one
component can be updated or when a differential update is used.
The necessary dependencies must be available prior to installation.<a href="#section-3.10-13" class="pilcrow">¶</a></p>
<p id="section-3.10-14">The download step is the process of acquiring a local copy of the
firmware image.  When the download is client-initiated, this means
that the firmware consumer chooses when a download occurs and initiates
the download process.  When a download is server-initiated,
this means that the status tracker tells
the device when to download or that it initiates the transfer
directly to the firmware consumer. For example, a download from an
HTTP-based firmware server is client-initiated. Pushing a manifest
and firmware image to the transfer to the Package resource of the LwM2M
Firmware Update object <span>[<a href="#LwM2M" class="xref">LwM2M</a>]</span> is server-initiated.<a href="#section-3.10-14" class="pilcrow">¶</a></p>
<p id="section-3.10-15">If the firmware consumer has downloaded a new firmware image and is ready to
install it, it may need to wait for a trigger from the status tracker to
initiate the installation, may trigger the update automatically, or
may go through a more complex decision making process to determine
the appropriate timing for an update (such as delaying the update
process to a later time when end users are less impacted by the
update process).<a href="#section-3.10-15" class="pilcrow">¶</a></p>
<p id="section-3.10-16">Installation is the act of processing the payload into a format that
the IoT device can recognise and the bootloader is responsible for
then booting from the newly installed firmware image.<a href="#section-3.10-16" class="pilcrow">¶</a></p>
<p id="section-3.10-17">Each of these steps may require different permissions.<a href="#section-3.10-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suitability-to-software-and-personalization-data">
<section id="section-3.11">
        <h3 id="name-suitability-to-software-and-">
<a href="#section-3.11" class="section-number selfRef">3.11. </a><a href="#name-suitability-to-software-and-" class="section-name selfRef">Suitability to software and personalization data</a>
        </h3>
<p id="section-3.11-1">The work on a standardized manifest format initially focused on the
most constrained IoT devices and those devices contain code put together
by a single author (although that author may obtain code from other
developers, some of it only in binary form).<a href="#section-3.11-1" class="pilcrow">¶</a></p>
<p id="section-3.11-2">Later it turns out that other use cases may benefit from a standardized
manifest format also for conveying software and even personalization data
alongside software. Trusted Execution Environments (TEEs), for example,
greatly benefit from a protocol for managing the lifecycle of trusted
applications (TAs) running inside a TEE. TEEs may obtain TAs
from different authors and those TAs may require personalization data,
such as payment information, to be securely conveyed to the TEE.<a href="#section-3.11-2" class="pilcrow">¶</a></p>
<p id="section-3.11-3">To support this wider range of use cases the manifest format should
therefore be extensible to convey other forms of payloads as well.<a href="#section-3.11-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claims">
<section id="section-4">
      <h2 id="name-claims-2">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-claims-2" class="section-name selfRef">Claims</a>
      </h2>
<p id="section-4-1">The information conveyed from an Author to a Firmware Consumer can be
considered to be Claims as described in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> and <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>.
The same security considerations apply to the Claims expressed in the
manifest. The chief difference between manifest Claims and CWT or JWT
claims is that a manifest has multiple subjects. The manifest contains:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-2">
<li id="section-4-2.1">Claims about the Firmware, including its dependencies<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-2.2">Claims about the Firmware Consumer's physical or software properties<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-2.3">Claims about the Author, or the Author's delegate<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-3">The credential used to authenticate these Claims must be directly
or indirectly related to the trust anchor installed at the device
by the Trust Provisioning Authority.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The baseline claims for all manifests are described in <span>[<a href="#I-D.ietf-suit-information-model" class="xref">I-D.ietf-suit-information-model</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="architecture">
<section id="section-5">
      <h2 id="name-communication-architecture-2">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-communication-architecture-2" class="section-name selfRef">Communication Architecture</a>
      </h2>
<p id="section-5-1"><a href="#arch-figure" class="xref">Figure 1</a> shows the communication architecture where a
firmware image is created by an author, and uploaded to a firmware
server. The firmware image/manifest is distributed to the device
either in a push or pull manner using the firmware consumer residing on
the device. The device operator keeps track of the process using
the status tracker. This allows the device operator to know and
control what devices have received an update and which of them are
still pending an update.<a href="#section-5-1" class="pilcrow">¶</a></p>
<span id="name-architecture-2"></span><div id="arch-figure">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-5-2.1">
<pre>
              Firmware +  +----------+       Firmware + +-----------+
              Manifest    |          |-+     Manifest   |           |-+
               +---------&gt;| Firmware | |&lt;---------------|           | |
               |          | Server   | |                |  Author   | |
               |          |          | |                |           | |
               |          +----------+ |                +-----------+ |
               |            +----------+                  +-----------+
               |
               |
               |
              -+--                                  ------
         ----  |  ----                          ----      ----
       //      |      \\                      //              \\
      /        |        \                    /                  \
     /         |         \                  /                    \
    /          |          \                /                      \
   /           |           \              /                        \
  |            v            |            |                          |
  |     +------------+                                              |
  |     |  Firmware  |      |            |                          |
 |      |  Consumer  |       | Device    |       +--------+          |
 |      +------------+       | Management|       |        |          |
 |      |            |&lt;-------------------------&gt;| Status |          |
 |      |   Device   |       |          |        | Tracker|          |
 |      +------------+       |          ||       |        |         |
  |                         |           ||       +--------+         |
  |                         |            |                          |
  |                         |             \                        /
   \                       /               \                      /
    \                     /                 \      Device        /
     \     Network       /                   \     Operator     /
      \   Operator      /                     \\              //
       \\             //                        ----      ----
         ----     ----                              ------
             -----

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-architecture-2" class="selfRef">Architecture.</a>
        </figcaption></figure>
</div>
<p id="section-5-3">End-to-end security mechanisms are used to protect the firmware
image and the manifest although <a href="#e2e-figure" class="xref">Figure 2</a> does not show the
manifest itself since it may be distributed independently.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-end-to-end-security-2"></span><div id="e2e-figure">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-5-4.1">
<pre>
                            +-----------+
+--------+                  |           |                   +--------+
|        |  Firmware Image  | Firmware  |   Firmware Image  |        |
| Device |&lt;-----------------| Server    |&lt;------------------| Author |
|        |                  |           |                   |        |
+--------+                  +-----------+                   +--------+
     ^                                                          *
     *                                                          *
     ************************************************************
                        End-to-End Security
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-end-to-end-security-2" class="selfRef">End-to-End Security.</a>
        </figcaption></figure>
</div>
<p id="section-5-5">Whether the firmware image and the manifest is pushed to the device or
fetched by the device is a deployment specific decision.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The following assumptions are made to allow the firmware consumer to verify the
received firmware image and manifest before updating software:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">To accept an update, a device needs to verify the signature covering
the manifest. There may be one or multiple manifests that need to be
validated, potentially signed by different parties. The device needs
to be in possession of the trust anchors to verify those signatures.
Installing trust anchors to devices via the Trust Provisioning Authority
happens in an out-of-band fashion prior to the firmware update process.<a href="#section-5-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-7.2">Not all entities creating and signing manifests have the same
permissions. A device needs to determine whether the requested action
is indeed covered by the permission of the party that signed the manifest.
Informing the device about the permissions of the different parties
also happens in an out-of-band fashion and is also a duty of the
Trust Provisioning Authority.<a href="#section-5-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-7.3">For confidentiality protection of firmware images the author needs
to be in possession of the certificate/public key or a pre-shared key
of a device. The use of confidentiality protection of firmware images
is deployment specific.<a href="#section-5-7.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-8">There are different types of delivery modes, which are illustrated
based on examples below.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">There is an option for embedding a firmware image into a manifest.
This is a useful approach for deployments where devices are not connected
to the Internet and cannot contact a dedicated firmware server for the firmware
download. It is also applicable when the firmware update happens via a
USB stick or via Bluetooth Smart. <a href="#attached-firmware-figure" class="xref">Figure 3</a> shows this
delivery mode graphically.<a href="#section-5-9" class="pilcrow">¶</a></p>
<span id="name-manifest-with-attached-firmw"></span><div id="attached-firmware-figure">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-5-10.1">
<pre>
              /------------\                 /------------\
             /Manifest with \               /Manifest with \
             |attached      |               |attached      |
             \firmware image/               \firmware image/
              \------------/  +-----------+  \------------/
  +--------+                  |           |                 +--------+
  |        |&lt;.................| Firmware  |&lt;................|        |
  | Device |                  | Server    |                 | Author |
  |        |                  |           |                 |        |
  +--------+                  +-----------+                 +--------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-manifest-with-attached-firmw" class="selfRef">Manifest with attached firmware.</a>
        </figcaption></figure>
</div>
<p id="section-5-11"><a href="#online-firmware-figure" class="xref">Figure 4</a> shows an option for remotely updating a device
where the device fetches the firmware image from some file server. The
manifest itself is delivered independently and provides information about
the firmware image(s) to download.<a href="#section-5-11" class="pilcrow">¶</a></p>
<span id="name-independent-retrieval-of-the"></span><div id="online-firmware-figure">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-5-12.1">
<pre>
             /--------\                     /--------\
            /          \                   /          \
            | Manifest |                   | Manifest |
            \          /                   \          /
             \--------/                     \--------/
                            +-----------+
+--------+                  |           |                 +--------+
|        |&lt;.................| Status    |................&gt;|        |
| Device |                  | Tracker   |              -- | Author |
|        |&lt;-                |           |            ---  |        |
+--------+  --              +-----------+          ---    +--------+
              --                                 ---
                ---                            ---
                   --       +-----------+    --
                     --     |           |  --
      /------------\   --   | Firmware  |&lt;-    /------------\
     /              \    -- | Server    |     /              \
     |   Firmware   |       |           |     |   Firmware   |
     \              /       +-----------+     \              /
      \------------/                           \------------/
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-independent-retrieval-of-the" class="selfRef">Independent retrieval of the firmware image.</a>
        </figcaption></figure>
</div>
<p id="section-5-13">This architecture does not mandate a specific delivery mode but a solution
must support both types.<a href="#section-5-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manifest">
<section id="section-6">
      <h2 id="name-manifest-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-manifest-2" class="section-name selfRef">Manifest</a>
      </h2>
<p id="section-6-1">In order for a device to apply an update, it has to make several decisions
about the update:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">Does it trust the author of the update?<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.2">Has the firmware been corrupted?<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.3">Does the firmware update apply to this device?<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.4">Is the update older than the active firmware?<a href="#section-6-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.5">When should the device apply the update?<a href="#section-6-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.6">How should the device apply the update?<a href="#section-6-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.7">What kind of firmware binary is it?<a href="#section-6-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.8">Where should the update be obtained?<a href="#section-6-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.9">Where should the firmware be stored?<a href="#section-6-2.9" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-3">The manifest encodes the information that devices need in order to
make these decisions. It is a data structure that contains the
following information:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">information about the device(s) the firmware image is intended to
be applied to,<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.2">information about when the firmware update has to be applied,<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.3">information about when the manifest was created,<a href="#section-6-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.4">dependencies on other manifests,<a href="#section-6-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.5">pointers to the firmware image and information about the format,<a href="#section-6-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.6">information about where to store the firmware image,<a href="#section-6-4.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.7">cryptographic information, such as digital signatures or message
authentication codes (MACs).<a href="#section-6-4.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-5">The manifest information model is described in <span>[<a href="#I-D.ietf-suit-information-model" class="xref">I-D.ietf-suit-information-model</a>]</span>.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="device-firmware-update-examples">
<section id="section-7">
      <h2 id="name-device-firmware-update-examp">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-device-firmware-update-examp" class="section-name selfRef">Device Firmware Update Examples</a>
      </h2>
<p id="section-7-1">Although these documents attempt to define a firmware update
architecture that is applicable to both existing systems, as well
as yet-to-be-conceived systems; it is still helpful to consider
existing architectures.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="single-cpu-soc">
<section id="section-7.1">
        <h3 id="name-single-cpu-soc-2">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-single-cpu-soc-2" class="section-name selfRef">Single CPU SoC</a>
        </h3>
<p id="section-7.1-1">The simplest, and currently most common, architecture consists of
a single MCU along with its own peripherals.  These SoCs generally
contain some amount of flash memory for code and fixed data, as
well as RAM for working storage.  These systems either have a single
firmware image, or an immutable bootloader that runs a single image.
A notable characteristic of these SoCs is that the primary code is
generally execute in place (XIP).  Combined with the non-relocatable
nature of the code, firmware updates need to be done in place.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="single-cpu-with-secure-normal-mode-partitioning">
<section id="section-7.2">
        <h3 id="name-single-cpu-with-secure-norma">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-single-cpu-with-secure-norma" class="section-name selfRef">Single CPU with Secure - Normal Mode Partitioning</a>
        </h3>
<p id="section-7.2-1">Another configuration consists of a similar architecture to the
previous, with a single CPU.  However, this CPU supports a security
partitioning scheme that allows memory (in addition to other things)
to be divided into secure and normal mode.  There will generally be
two images, one for secure mode, and one for normal mode.  In this
configuration, firmware upgrades will generally be done by the CPU
in secure mode, which is able to write to both areas of the flash
device. In addition, there are requirements to be able to update
either image independently, as well as to update them together
atomically, as specified in the associated manifests.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetric-multiple-cpus">
<section id="section-7.3">
        <h3 id="name-symmetric-multiple-cpus-2">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-symmetric-multiple-cpus-2" class="section-name selfRef">Symmetric Multiple CPUs</a>
        </h3>
<p id="section-7.3-1">In more complex SoCs with symmetric multi-processing support, advanced
operating systems, such as Linux, are often used. These SoCs frequently
use an external storage medium such as raw NAND flash or eMMC. Due to
the higher quantity of resources, these devices are often capable of
storing multiple copies of their firmware images and selecting the most
appropriate one to boot. Many SoCs also support bootloaders that are
capable of updating the firmware image, however this is typically a last
resort because it requires the device to be held in the bootloader while
the new firmware is downloaded and installed, which results in down-time
for the device. Firmware updates in this class of device are typically
not done in-place.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dual-cpu-shared-memory">
<section id="section-7.4">
        <h3 id="name-dual-cpu-shared-memory-2">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-dual-cpu-shared-memory-2" class="section-name selfRef">Dual CPU, shared memory</a>
        </h3>
<p id="section-7.4-1">This configuration has two or more heterogeneous CPUs in a single SoC that share
memory (flash and RAM).  Generally, they will be a protection mechanism
to prevent one CPU from accessing the other's memory. Upgrades in this
case will typically be done by one of the CPUs, and is similar to the
single CPU with secure mode.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dual-cpu-other-bus">
<section id="section-7.5">
        <h3 id="name-dual-cpu-other-bus-2">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-dual-cpu-other-bus-2" class="section-name selfRef">Dual CPU, other bus</a>
        </h3>
<p id="section-7.5-1">This configuration has two or more heterogeneous CPUs, each having their own memory.
There will be a communication channel between them, but it will be
used as a peripheral, not via shared memory.  In this case, each CPU
will have to be responsible for its own firmware upgrade.  It is
likely that one of the CPUs will be considered the primary CPU, and will
direct the other CPU to do the upgrade.  This configuration is
commonly used to offload specific work to other CPUs.  Firmware
dependencies are similar to the other solutions above, sometimes
allowing only one image to be upgraded, other times requiring several
to be upgraded atomically.  Because the updates are happening on
multiple CPUs, upgrading the two images atomically is challenging.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bootloader">
<section id="section-8">
      <h2 id="name-bootloader-2">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-bootloader-2" class="section-name selfRef">Bootloader</a>
      </h2>
<p id="section-8-1">More devices today than ever before are being connected to the Internet,
which drives the need for firmware updates to be provided over the
Internet rather than through traditional interfaces, such as USB or
RS232. Updating a device over the Internet requires the device to fetch
not only the firmware image but also the manifest. Hence, the following
building blocks are necessary for a firmware update solution:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">the Internet protocol stack for firmware downloads (*),<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.2">the capability to write the received firmware image to
persistent storage (most likely flash memory) prior to performing
the update,<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.3">the ability to unpack, decompress or otherwise process the received
firmware image,<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.4">the features to verify an image and a manifest, including digital
signature verification or checking a message authentication code,<a href="#section-8-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.5">a manifest parsing library, and<a href="#section-8-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.6">integration of the device into a device management server to
perform automatic firmware updates and to track their progress.<a href="#section-8-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-3">(*) Because firmware images are often multiple kilobytes, sometimes
exceeding one hundred kilobytes, in size for low end IoT devices and even
several megabytes large for IoT devices running full-fledged operating systems
like Linux, the protocol mechanism for retrieving these images needs
to offer features like congestion control, flow control, fragmentation
and reassembly, and mechanisms to resume interrupted or corrupted transfers.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">All these features are most likely offered by the application, i.e.
firmware consumer, running
on the device (except for basic security algorithms that may run
either on a trusted execution environment or on a separate hardware
security MCU/module) rather than by the bootloader itself.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Once manifests have been processed and firmware images successfully
downloaded and verified the device needs to hand control over to the
bootloader.  In most cases this requires the MCU to restart. Once the
MCU has initiated a restart, the bootloader takes over control and
determines whether the newly downloaded firmware
image should be executed.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">The boot process is security sensitive
because the firmware images may, for example, be stored in off-chip
flash memory giving attackers easy access to the image for reverse
engineering and potentially also for modifying the binary.  The
bootloader will therefore have to perform security checks on the
firmware image before it can be booted. These security checks by the
bootloader happen in addition to the security checks that happened
when the firmware image and the manifest were downloaded.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">The manifest may have been stored alongside the firmware image to
allow re-verification of the firmware image during every boot
attempt.  Alternatively, secure boot-specific meta-data may have been
created by the application after a successful firmware download
and verification process.  Whether to re-use the standardized
manifest format that was used during the initial firmware retrieval
process or whether it is better to use a different format for the
secure boot-specific meta-data depends on the system design.  The
manifest format does, however, have the capability to serve also as a
building block for secure boot with its severable elements that allow
shrinking the size of the manifest by stripping elements that are no
longer needed.<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8">In order to satisfy the reliability requirements defined in
<a href="#reliability" class="xref">Section 3.5</a>, devices must always be able to return to a working
firmware image. This has implications for the design of the bootloader:
If the firmware image contains the firmware consumer
functionality, as described above, then the bootloader must be able to
roll back to a working firmware image. Alternatively, the bootloader
may have enough functionality to
fetch a firmware image plus manifest from a firmware server over the
Internet.  A multi-stage bootloader may soften this requirement at
the expense of a more sophisticated boot process.<a href="#section-8-8" class="pilcrow">¶</a></p>
<p id="section-8-9">For a bootloader to offer a secure boot mechanism it needs to provide
the following features:<a href="#section-8-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-10.1">ability to access security algorithms, such as SHA-256 to compute
a fingerprint over the firmware image and a digital signature
algorithm.<a href="#section-8-10.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-10.2">access keying material directly or indirectly to utilize the
digital signature.  The device needs to have a trust anchor store.<a href="#section-8-10.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-10.3">ability to expose boot process-related data to the application
firmware (such as to the device management software).  This allows
a device management server to determine whether the firmware
update has been successful and, if not, what errors occurred.<a href="#section-8-10.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-10.4">to (optionally) offer attestation information (such as
measurements).<a href="#section-8-10.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-11">While the software architecture of the bootloader and its
security mechanisms are implementation-specific, the manifest can
be used to control the firmware download from the Internet in
addition to augmenting secure boot process. These building blocks
are highly relevant for the design of the manifest.<a href="#section-8-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example">
<section id="section-9">
      <h2 id="name-example-2">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
      </h2>
<p id="section-9-1"><a href="#firmware-update" class="xref">Figure 5</a> illustrates an example message flow
for distributing a firmware image to a device
starting with an author uploading the new firmware to
firmware server and creating a manifest. The firmware
and manifest are stored on the same firmware server. This
setup does not use a status tracker and the firmware consumer
component is therefore responsible for periodically checking
whether a new firmware image is available for download.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-first-example-flow-for-a-fir"></span><div id="firmware-update">
<figure id="figure-5">
        <div class="artwork art-text alignLeft" id="section-9-2.1">
<pre>
+--------+    +-----------------+      +------------+ +----------+
|        |    |                 |      |  Firmware  | |          |
| Author |    | Firmware Server |      |  Consumer  | |Bootloader|
+--------+    +-----------------+      +------------+ +----------+
  |                   |                     |                +
  | Create Firmware   |                     |                |
  |--------------+    |                     |                |
  |              |    |                     |                |
  |&lt;-------------+    |                     |                |
  |                   |                     |                |
  | Upload Firmware   |                     |                |
  |------------------&gt;|                     |                |
  |                   |                     |                |
  | Create Manifest   |                     |                |
  |---------------+   |                     |                |
  |               |   |                     |                |
  |&lt;--------------+   |                     |                |
  |                   |                     |                |
  | Sign Manifest     |                     |                |
  |-------------+     |                     |                |
  |             |     |                     |                |
  |&lt;------------+     |                     |                |
  |                   |                     |                |
  | Upload Manifest   |                     |                |
  |------------------&gt;|                     |                |
  |                   |                     |                |
  |                   |   Query Manifest    |                |
  |                   |&lt;--------------------|                |
  |                   |                     |                |
  |                   |   Send Manifest     |                |
  |                   |--------------------&gt;|                |
  |                   |                     | Validate       |
  |                   |                     | Manifest       |
  |                   |                     |---------+      |
  |                   |                     |         |      |
  |                   |                     |&lt;--------+      |
  |                   |                     |                |
  |                   |  Request Firmware   |                |
  |                   |&lt;--------------------|                |
  |                   |                     |                |
  |                   | Send Firmware       |                |
  |                   |--------------------&gt;|                |
  |                   |                     | Verify         |
  |                   |                     | Firmware       |
  |                   |                     |--------------+ |
  |                   |                     |              | |
  |                   |                     |&lt;-------------+ |
  |                   |                     |                |
  |                   |                     | Store          |
  |                   |                     | Firmware       |
  |                   |                     |-------------+  |
  |                   |                     |             |  |
  |                   |                     |&lt;------------+  |
  |                   |                     |                |
  |                   |                     |                |
  |                   |                     | Trigger Reboot |
  |                   |                     |---------------&gt;|
  |                   |                     |                |
  |                   |                     |                |
  |                   |                 +---+----------------+--+
  |                   |                S|   |                |  |
  |                   |                E|   | Verify         |  |
  |                   |                C|   | Firmware       |  |
  |                   |                U|   | +--------------|  |
  |                   |                R|   | |              |  |
  |                   |                E|   | +-------------&gt;|  |
  |                   |                 |   |                |  |
  |                   |                B|   | Activate new   |  |
  |                   |                O|   | Firmware       |  |
  |                   |                O|   | +--------------|  |
  |                   |                T|   | |              |  |
  |                   |                 |   | +-------------&gt;|  |
  |                   |                P|   |                |  |
  |                   |                R|   | Boot new       |  |
  |                   |                O|   | Firmware       |  |
  |                   |                C|   | +--------------|  |
  |                   |                E|   | |              |  |
  |                   |                S|   | +-------------&gt;|  |
  |                   |                S|   |                |  |
  |                   |                 +---+----------------+--+
  |                   |                     |                |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-first-example-flow-for-a-fir" class="selfRef">First Example Flow for a Firmware Upate.</a>
        </figcaption></figure>
</div>
<p id="section-9-3"><a href="#firmware-update2" class="xref">Figure 6</a> shows an example follow with the device using
a status tracker. For editorial reasons the author publishing the
manifest at the status tracker and the firmware image at the firmware
server is not shown. Also omitted is the secure boot process
following the successful firmware update process.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The exchange starts with the device interacting with the status
tracker; the details of such exchange will vary with the different
device management systems being used. In any case, the status
tracker learns about the firmware version of the devices it
manages. In our example, the device under management is using
firmware version A.B.C. At a later point in time the author uploads
a new firmware along with the manifest to the firmware server and the
status tracker, respectively. While there is no need to store the
manifest and the firmware on different servers this example shows
a common pattern used in the industry. The status tracker may then
automatically, based on human intervention or based on a more
complex policy decide to inform the device about the newly available
firmware image. In our example, it does so by pushing the manifest
to the firmware consumer. The firmware consumer downloads the firmware
image with the newer version X.Y.Z after successful validation
of the manifest. Subsequently, a reboot is initiated and the secure
boot process starts.<a href="#section-9-4" class="pilcrow">¶</a></p>
<span id="name-second-example-flow-for-a-fi"></span><div id="firmware-update2">
<figure id="figure-6">
        <div class="artwork art-text alignLeft" id="section-9-5.1">
<pre>
 +---------+   +-----------------+    +-----------------------------+
 | Status  |   |                 |    | +------------+ +----------+ |
 | Tracker |   | Firmware Server |    | |  Firmware  | |Bootloader| |
 |         |   |                 |    | |  Consumer  | |          | |
 +---------+   +-----------------+    | +------------+ +----------+ |
      |                |              |      |  IoT Device    |     |
      |                |               `''''''''''''''''''''''''''''
      |                |                     |                |
      |        Query Firmware Version        |                |
      |-------------------------------------&gt;|                |
      |        Firmware Version A.B.C        |                |
      |&lt;-------------------------------------|                |
      |                |                     |                |
      |         &lt;&lt;some time later&gt;&gt;          |                |
      |                |                     |                |
    _,...._         _,...._                  |                |
  ,'       `.     ,'       `.                |                |
 |   New     |   |   New     |               |                |
 \ Manifest  /   \ Firmware  /               |                |
  `.._   _,,'     `.._   _,,'                |                |
      `''             `''                    |                |
      |            Push manifest             |                |
      |----------------+--------------------&gt;|                |
      |                |                     |                |
      |                '                     |                '
      |                |                     | Validate       |
      |                |                     | Manifest       |
      |                |                     |---------+      |
      |                |                     |         |      |
      |                |                     |&lt;--------+      |
      |                | Request firmware    |                |
      |                | X.Y.Z               |                |
      |                |&lt;--------------------|                |
      |                |                     |                |
      |                | Firmware X.Y.Z      |                |
      |                |--------------------&gt;|                |
      |                |                     |                |
      |                |                     | Verify         |
      |                |                     | Firmware       |
      |                |                     |--------------+ |
      |                |                     |              | |
      |                |                     |&lt;-------------+ |
      |                |                     |                |
      |                |                     | Store          |
      |                |                     | Firmware       |
      |                |                     |-------------+  |
      |                |                     |             |  |
      |                |                     |&lt;------------+  |
      |                |                     |                |
      |                |                     |                |
      |                |                     | Trigger Reboot |
      |                |                     |---------------&gt;|
      |                |                     |                |
      |                |                     |                |
      |                |                     | __..-------..._'
      |                |                    ,-'               `-.
      |                |                   |      Secure Boot    |
      |                |                   `-.                 _/
      |                |                     |`--..._____,,.,-'
      |                |                     |                |
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-second-example-flow-for-a-fi" class="selfRef">Second Example Flow for a Firmware Upate.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations-2">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations-2" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document does not require any actions by IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations-2">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">Firmware updates fix security vulnerabilities and are considered to be
an important building block in securing IoT devices. Due to the
importance of firmware updates for IoT devices the Internet
Architecture Board (IAB) organized a 'Workshop on Internet of Things
(IoT) Software Update (IOTSU)', which took place at Trinity College
Dublin, Ireland on the 13th and 14th of June, 2016 to take a look at
the big picture. A report about this workshop can be found at
<span>[<a href="#RFC8240" class="xref">RFC8240</a>]</span>. A standardized firmware manifest format providing
end-to-end security from the author to the device will be specified
in a separate document.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">There are, however, many other considerations raised during the
workshop. Many of them are outside the scope of standardization
organizations since they fall into the realm of product engineering,
regulatory frameworks, and business models. The following
considerations are outside the scope of this document, namely<a href="#section-11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">installing firmware updates in a robust fashion so that the
update does not break the device functionality of the environment
this device operates in.<a href="#section-11-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-3.2">installing firmware updates in a timely fashion considering the
complexity of the decision making process of updating devices,
potential re-certification requirements, and the need for user
consent to install updates.<a href="#section-11-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-3.3">the distribution of the actual firmware update, potentially in
an efficient manner to a large number of devices without human
involvement.<a href="#section-11-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-3.4">energy efficiency and battery lifetime considerations.<a href="#section-11-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-3.5">key management required for verifying the digital signature
protecting the manifest.<a href="#section-11-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-3.6">incentives for manufacturers to offer a firmware update mechanism
as part of their IoT products.<a href="#section-11-3.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="section-12">
      <h2 id="name-acknowledgements-2">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgements-2" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-12-1">We would like to thank the following persons for their feedback:<a href="#section-12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-2.1">Geraint Luff<a href="#section-12-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.2">Amyas Phillips<a href="#section-12-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.3">Dan Ros<a href="#section-12-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.4">Thomas Eichinger<a href="#section-12-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.5">Michael Richardson<a href="#section-12-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.6">Emmanuel Baccelli<a href="#section-12-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.7">Ned Smith<a href="#section-12-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.8">Jim Schaad<a href="#section-12-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.9">Carsten Bormann<a href="#section-12-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.10">Cullen Jennings<a href="#section-12-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.11">Olaf Bergmann<a href="#section-12-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.12">Suhas Nandakumar<a href="#section-12-2.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.13">Phillip Hallam-Baker<a href="#section-12-2.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.14">Marti Bolivar<a href="#section-12-2.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.15">Andrzej Puzdrowski<a href="#section-12-2.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.16">Markus Gueller<a href="#section-12-2.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.17">Henk Birkholz<a href="#section-12-2.17" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.18">Jintao Zhu<a href="#section-12-2.18" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.19">Takeshi Takahashi<a href="#section-12-2.19" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.20">Jacob Beningo<a href="#section-12-2.20" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.21">Kathleen Moriarty<a href="#section-12-2.21" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-12-3">We would also like to thank the WG chairs, Russ Housley, David Waltermire,
Dave Thaler for their support and their reviews.<a href="#section-12-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-informative-references-2">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-suit-information-model">[I-D.ietf-suit-information-model]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and H. Birkholz</span>, <span class="refTitle">"An Information Model for Firmware Updates in IoT Devices"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-information-model-07</span>, <time datetime="2020-06-02" class="refDate">June 2, 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-suit-information-model-07.txt">http://www.ietf.org/internet-drafts/draft-ietf-suit-information-model-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-manifest">[I-D.ietf-suit-manifest]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Birkholz, H.</span><span class="refAuthor">, and K. Zandberg</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-09</span>, <time datetime="2020-07-13" class="refDate">July 13, 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-suit-manifest-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-suit-manifest-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[I-D.ietf-teep-architecture]</dt>
      <dd>
<span class="refAuthor">Pei, M.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Thaler, D.</span><span class="refAuthor">, and D. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-12</span>, <time datetime="2020-07-13" class="refDate">July 13, 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-teep-architecture-12.txt">http://www.ietf.org/internet-drafts/draft-ietf-teep-architecture-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LwM2M">[LwM2M]</dt>
      <dd>
<span class="refAuthor">OMA, .</span>, <span class="refTitle">"Lightweight Machine to Machine Technical Specification, Version 1.0.2"</span>, <time datetime="2018-02-09" class="refDate">February 9, 2018</time>, <span>&lt;<a href="http://www.openmobilealliance.org/release/LightweightM2M/V1_0_2-20180209-A/OMA-TS-LightweightM2M-V1_0_2-20180209-A.pdf">http://www.openmobilealliance.org/release/LightweightM2M/V1_0_2-20180209-A/OMA-TS-LightweightM2M-V1_0_2-20180209-A.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
      <dd>
<span class="refAuthor">Reddy, R.</span><span class="refAuthor"> and C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6024">https://www.rfc-editor.org/info/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Ersue, M.</span><span class="refAuthor">, and A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8240">[RFC8240]</dt>
      <dd>
<span class="refAuthor">Tschofenig, H.</span><span class="refAuthor"> and S. Farrell</span>, <span class="refTitle">"Report from the Internet of Things Software Update (IoTSU) Workshop 2016"</span>, <span class="seriesInfo">RFC 8240</span>, <span class="seriesInfo">DOI 10.17487/RFC8240</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8240">https://www.rfc-editor.org/info/rfc8240</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Wahlstroem, E.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8778">[RFC8778]</dt>
    <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Use of the HSS/LMS Hash-Based Signature Algorithm with CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8778</span>, <span class="seriesInfo">DOI 10.17487/RFC8778</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8778">https://www.rfc-editor.org/info/rfc8778</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brendan Moran</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Brendan.Moran@arm.com" class="email">Brendan.Moran@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@arm.com" class="email">hannes.tschofenig@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Brown</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david.brown@linaro.org" class="email">david.brown@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Milosch Meriac</span></div>
<div dir="auto" class="left"><span class="org">Consultant</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:milosch@meriac.com" class="email">milosch@meriac.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
